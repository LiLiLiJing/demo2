<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>demo</title>
		<meta name="description" content="">
		<meta name="keywords" content="">
		<script src="../static/libs/jquery-1.11.2.min.js" type="text/javascript"></script>
		<style type="text/css">
			* {
            padding: 0;
            margin: 0;
			font: 14px "微软雅黑";
        	}
			body{
				background-color:#eee;
				}
			img{
				border:none;
				width:100px;
				height:100px;
				}
			ul,ol{
				list-style:none;
			}
	        table {
	            border-collapse: collapse;
	            border-spacing: 0;
	            border: 1px solid #c0c0c0;
	            width: 95%;
	            margin-bottom:15px;
				}
	        table:hover{
	            background-color: #fafafa;
	        }
	        table div{
            font-size:14px;
            font-weight:bold;
        	}
	        th,
	        td {
	            border: 1px solid #d0d0d0;
	            color: #404060;
	            padding: 10px;
	        }
	        td{
            
            word-break:break-all;
            
	        }
	        .contents{
	        	width:1300px;
	        	margin:50px auto;
	        	border:1px solid red;
	        	position:relative;
	        }
	        .fl{
	        	float:left;
	        }
	        .fr{
	        	float:right;
	        }
	        .clearfix:after{
				content:'';
				display:block;
				clear:both;
			}
			.left{
				margin:5px;
			}
			.left ul{
				width:200px;
			}
			.left li{
				background-color:orange;
				margin-bottom:5px;
				height:58px;
				overflow:hidden;
				cursor:pointer;
			}
			.left li:hover{
				background-color:#fff;
			}
			.right{
				width: 1050px;
				padding-left:18px;
				position:absolute;
				top:0px;
				left:220px;
			}
			.right li{
				width:100px;
				height: 136px;
				float:left;
				margin:5px;
				cursor:pointer;
            	text-align:center;
            	word-break:break-all;
				position:relative;
			}
			.right span{
				display:block;
			}
			.infoBox{
				background-color: skyblue;
				color:#fff;
				position:absolute;
				border-radius:5px;
				width:90px;
				top:25px;
				left:95px;
				z-index:2;
				display:none;
			}
			.shape{
				width: 0;
    			height: 0;
    			border-top: 10px solid transparent;
    			border-right: 15px solid skyblue;
    			border-bottom: 10px solid transparent;
    			position:absolute;
    			top:10px;
				left:-15px;
			}
		</style>
	</head>
	
	<body>
		<div class="contents clearfix">
			<div class="left fl">
				<ul>
					
				</ul>
			</div>
			<div class="right fl">
				<ul>
					
				</ul>
			</div>
		</div>
		
	</body>
	
	<script type="text/javascript">
		function imgInfo(info,index){
			var str="";
			var str1="";
			var storenameArr=[];
			var workspaceArr=[];
			var j=0;
			var oneArr;
			for(var i=0;i<info.length;i++){
				var storename=info[i].storename;
				storenameArr.push(storename);
			}
			for(var i=0;i<info.length;i++){
				var spacename=info[i].workspacename;
				workspaceArr.push(spacename);
			}
			for(var i=0;i<workspaceArr.length;i++){				
				$.ajax({
	                url:'http://172.18.77.15:31555/thumbnail&'+workspaceArr[i],
	                type:'get',
	                dataType:'JSON',
	                success:function(data){
	                	var flag=storenameArr[j];
	                	
	                	for(var k=0;k<data.length;k++){
	                		if(flag==data[k].name){
	                			str1+='<li>'+
	                			'<img src="'+data[k].url+'">'+
	                			'<span>'+data[k].name+'</span>'+
	                			'<div class="infoBox">'+ 
	                			'<p class="one">单图绘制</p>'+
	                			'<p class="much">多图绘制</p>'+
	                			'<div class="shape"></div>'+
	                			'</div>'+
	                			'</li>'
	                		}
	                	}
	                	$(".right>ul").html(str1);
	                	$(".right>ul>li").hover(function(){
	                		$(this).find(".infoBox").show();
	                		},function(){
	                		$(this).find(".infoBox").hide();
	                		}
	                	);
	                	$(".right>ul>li").find(".much").click(function(){
	                		var flagtext=$(this).parent().parent().find("span").text();
	                		window.open('/lblorder-manip&proc-order:'+index+':'+flagtext);
	                	})
	                	
	                	j++;


	                	
	                }

            	})
			}
			
			
		}

		//获取数据函数
		function show(){
			$.ajax({
				url:'http://172.18.77.15:{{store_dict['port_number']}}/lblorder-manip&get-orders',
				type:'POST',
				dataType:'JSON',
				success:function(data){
					var str="";
					for(var i=0;i<data.length;i++){
						str+='<li data-index='+data[i].id+'>';
						str+='<div>id:'+data[i].id+'</div>'+
							 
							 '<div>描述信息:<br>'+data[i].description+'</div>'
						str+='</li>';
					}
					$(".left>ul").html(str);
					$(".left>ul>li").click(function(){
						var index=$(this)[0].dataset['index'];
						$.ajax({
							url:'http://172.18.77.15:{{store_dict['port_number']}}/lblorder-manip&proc-order:'+index+':json',
							type:'POST',
							dataType:'JSON',
							success:function(info){

								imgInfo(info.storeinfos,index);
							},
							error:function(){

							}
						});
					});
					
				},
				error:function(err){
					console.log(err);
				}
			})
		}
		show();
		//向下滑动，图片跟随显示
		function scroll() {  // 开始封装自己的scrollTop
    		if(window.pageYOffset != null) {  // ie9+ 高版本浏览器
        // 因为 window.pageYOffset 默认的是  0  所以这里需要判断
	        	return {
		            left: window.pageXOffset,
		            top: window.pageYOffset
	        	}
    		}
    		else if(document.compatMode === "CSS1Compat") {    // 标准浏览器   来判断有没有声明DTD
        		return {
		            left: document.documentElement.scrollLeft,
		            top: document.documentElement.scrollTop
        		}
    		}
		    return {   // 未声明 DTD
		        left: document.body.scrollLeft,
		        top: document.body.scrollTop
		    }
		}
		var pic = document.getElementsByClassName("right")[0];
    	window.onscroll = function() {
        	animate(pic,scroll().top);
    	}

	    function animate(obj,target) {
	        clearInterval(obj.timer);
	        obj.timer = setInterval(function() {
	            // 运动公式  leader = leader + (target - leadaer) / 10
	            var step = (target - obj.offsetTop) / 10;
	            step = step > 0 ? Math.ceil(step) : Math.floor(step);
	            obj.style.top = obj.offsetTop + step + "px";
	            if(target == obj.offsetTop) {
	                clearInterval(obj.timer);
	            }
	        },30)
	    }
	    //点击图片进行跳转
	    
	    
	</script>
</html>